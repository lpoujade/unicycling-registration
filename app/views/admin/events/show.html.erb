<h1><%= @event %> Report</h1>

<table>
  <caption>Event-Competitor-Breakdown</caption>
  <thead>
    <th>Name</th>
    <th>Country</th>
    <% @event.event_choices.each do |choice| %>
      <% next unless choice.position > 1 %>
      <th><%= choice.label %></th>
    <% end %>
  </thead>
  <tbody>
    <% @event.primary_choice.registrant_choices.each do |reg_choice| %>
      <% next unless reg_choice.value == "1"  %>
      <tr>
        <td><%= reg_choice.registrant %></td>
        <td><%= reg_choice.registrant.country %></td>
        <% @event.event_choices.each do |choice| %>
          <% choice.registrant_choices.where({:registrant_id => reg_choice.registrant.id}).each do |reg| %>
            <% next unless reg.event_choice.position > 1 %>
            <td><%= reg.value %></td>
          <% end %>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>
