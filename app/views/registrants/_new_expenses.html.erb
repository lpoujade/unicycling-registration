<% ExpenseGroup.visible.includes(:expense_items).all.each do |expense_group| %>
  <fieldset class="data_block">
    <legend>Add <%= expense_group %></legend>
    <table>
      <% unless expense_group.info_url.blank? %>
        <tr>
          <td colspan="3">
            <div class="event_link">
              <%= link_to 'More Info [' + expense_group.to_s + ']', expense_group.info_url, {:target => "_blank", :class=> "external_link"} %>
            </div>
          </td>
        </tr>
      <% end %>
      <% expense_group.expense_items.each do |ei| %>
        <% @registrant_expense_item = RegistrantExpenseItem.new(:expense_item_id => ei.id, :registrant_id => @registrant.id) %>
        <%= render :partial => "/registrants/new_expense", :locals => { :item => ei, :show_as_free => @registrant.expense_item_is_free(ei) } %>
      <% end %>
    </table>
  </fieldset>
<% end %>
