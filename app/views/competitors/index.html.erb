<h1><%= @competition %> - Competitors</h1>

<table class="sortable">
  <thead>
    <tr>
      <th class="competitor_member">Order</th>
      <th class="sign_up">ID</th>
      <th class="sign_up">Name</th>
      <th class="sign_up">Age</th>
      <th class="sign_up">Gender</th>
      <th class="sign_up">Age Group</th>
      <th class="sign_up">Original Event Selection</th>
      <th class="competitor_member">Competition</th>
      <th class="competitor_member"></th>
    </tr>
  </thead>
  <tbody>
    <% @competitors.each do |competitor| %>
        <% event_category = nil
           registrant = competitor.members.first.registrant
        %>
        <% event_category = registrant.registrant_event_sign_ups.where({:event_id => @competition.event.id}).try(:first).try(:event_category) %>
      <tr>
        <td><%= competitor.position %></td>
        <td><%= competitor.external_id %></td>
        <td><%= competitor.detailed_name %></td>
        <td><%= competitor.age %></td>
        <td><%= competitor.gender %></td>
        <td><% unless @competition.age_group_type.nil? %>
            <%= @competition.age_group_type.age_group_entry_description(registrant.age, registrant.gender, registrant.default_wheel_size.id) %>
          <% end %>
        </td>
        <td><%= event_category %></td>
        <td><%= @competition %></td>
        <td>
            <%= link_to 'Edit', edit_competitor_path(competitor) %>
            <%= link_to 'Destroy', competitor, method: :delete, data: { confirm: 'Are you sure?' } %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<%= link_to 'Upload or Create Competitor', new_competition_competitor_path(@competition) %><br />
<%= link_to "Printing Menu", printing_competition_path(@competition) %>
